<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proyecto Final – BrannyCMS</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex flex-col font-sans">
    <!-- Encabezado principal con logo y metadatos académicos -->
    <header class="bg-indigo-700 text-white shadow-lg">
      <div
        class="container mx-auto px-4 py-3 flex flex-col gap-4 md:flex-row md:items-center md:justify-between"
      >
        <!-- Logo + título -->
        <div class="flex items-center gap-3">
          <img
            src="logo_empresa.png"
            alt="Logo de la empresa"
            class="h-12 w-12 rounded-full border border-white shadow"
          />
          <h1 class="text-2xl font-semibold leading-tight">
            BrannyCMS
            <span class="block text-sm font-light"
              >Mini Gestor de Contenido</span
            >
          </h1>
        </div>
        <!-- Datos del estudiante -->
        <div class="text-right text-xs leading-tight md:text-left">
          <p>Estudiante: <strong>Branny Smith Severino</strong></p>
          <p>Matrícula: <strong>202003617</strong></p>
        </div>
        <!-- Datos del profesor y asignatura -->
        <div class="text-right text-xs leading-tight">
          <p>Profesor: <strong>Gregorio De La Rosa</strong></p>
          <p>
            Asignatura:
            <strong>Gestión del Conocimiento y la Toma de Decisiones</strong>
          </p>
        </div>
      </div>
      <!-- Barra de utilidades -->
      <nav class="bg-indigo-800 text-center text-xs py-1">
        <button id="clearAll" class="underline hover:text-gray-200">
          Borrar todo el contenido
        </button>
      </nav>
    </header>

    <!-- Contenido principal -->
    <main class="flex-1 container mx-auto px-4 py-8 grid md:grid-cols-5 gap-8">
      <!-- Formulario de creación -->
      <section class="bg-white rounded-2xl shadow px-6 py-8 md:col-span-2">
        <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5"
              d="M12 4v16m8-8H4"
            />
          </svg>
          Nuevo artículo
        </h2>
        <form id="postForm" class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-gray-700 mb-1"
              for="title"
              >Título</label
            >
            <input
              type="text"
              id="title"
              required
              class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-gray-700 mb-1"
              for="content"
              >Contenido</label
            >
            <textarea
              id="content"
              rows="5"
              required
              class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
            ></textarea>
          </div>
          <button
            type="submit"
            class="bg-indigo-600 text-white px-4 py-2 rounded-lg w-full hover:bg-indigo-700 transition"
          >
            Publicar
          </button>
        </form>
      </section>

      <!-- Lista de artículos publicados -->
      <section class="bg-white rounded-2xl shadow px-6 py-8 md:col-span-3">
        <h2 class="text-xl font-bold mb-4">Artículos publicados</h2>
        <div id="postsContainer" class="space-y-4"></div>
      </section>
    </main>

    <!-- Pie de página -->
    <footer class="bg-gray-200 text-gray-600 text-sm text-center py-4">
      Proyecto final CMS • UAPA 2025 &copy; Branny S.
    </footer>

    <!-- Lógica de la aplicación -->
    <script>
      const form = document.getElementById("postForm");
      const postsContainer = document.getElementById("postsContainer");
      const clearAllBtn = document.getElementById("clearAll");

      // Recuperar artículos guardados
      let posts = JSON.parse(localStorage.getItem("brannycms_posts") || "[]");

      const savePosts = () => {
        localStorage.setItem("brannycms_posts", JSON.stringify(posts));
      };

      const renderPosts = () => {
        postsContainer.innerHTML = "";
        if (posts.length === 0) {
          postsContainer.innerHTML =
            '<p class="text-gray-400 text-sm">Aún no hay artículos.</p>';
          return;
        }
        posts.forEach((post, idx) => {
          const card = document.createElement("article");
          card.className =
            "border rounded-lg p-4 shadow group hover:shadow-lg transition";
          card.innerHTML = `
          <h3 class="font-semibold text-lg mb-2">${post.title}</h3>
          <p class="text-gray-700 whitespace-pre-wrap">${post.content}</p>
          <button data-idx="${idx}" class="mt-3 text-xs text-red-600 underline opacity-0 group-hover:opacity-100">Eliminar</button>
        `;
          postsContainer.appendChild(card);
        });
      };

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const title = document.getElementById("title").value.trim();
        const content = document.getElementById("content").value.trim();
        if (!title || !content) return;
        posts.unshift({ title, content, created: Date.now() });
        savePosts();
        renderPosts();
        form.reset();
      });

      postsContainer.addEventListener("click", (e) => {
        if (e.target.matches("button[data-idx]")) {
          const idx = e.target.dataset.idx;
          posts.splice(idx, 1);
          savePosts();
          renderPosts();
        }
      });

      clearAllBtn.addEventListener("click", () => {
        if (confirm("¿Borrar todos los artículos?")) {
          posts = [];
          savePosts();
          renderPosts();
        }
      });

      // Render inicial
      renderPosts();
    </script>
  </body>
</html>
